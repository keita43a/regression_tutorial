# Rを使ってみる {#letsuse}


## 計算機としてのR

### 演習：R Scriptの作成

- `r_renshu`プロジェクトを開く。
- 新たに`r_trial.R`という名前のRスクリプトを作成しよう。
  - スクリプトの作り方を忘れた人はセクション\@ref(scriptmake)を参照。
- 以下の演算をそのスクリプトに書いて実行してみよう。

### 足し算・引き算

```{r, echo =TRUE}
1 + 1
```

```{r, echo =TRUE}
400 - 50
```

### かけ算・割り算

掛け算はアスタリスク(*)を使う。 

```{r, echo =TRUE}

2 * 3
```


割り算はスラッシュ(/)を使う

```{r, echo =TRUE}

(2+7)/3
```

割り切れない場合はある程度まで桁が表示

```{r, echo =TRUE}
10/3
```

### **練習問題**：以下の演算をRを使ってやってみよう {#practicecalc}

1. $9179\div67$
2. $(256\times 43 + 54)\div 8$
3. $1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 + 12$

### 論理演算

論理演算は書いてあることが真か偽か？を評価する。

```{r}
# 「10は5より大きい」という命題は正しい？
10 > 5
```

```{r}
# 「3は5より大きい」という命題は正しい？
3 > 5
```

```{r}
# 「等しい」は=が2つ。１つだと「代入」という意味になってしまう。
"musashi" == "musashi"
```

```{r}
"musashi" == "634"
```


## プログラミング言語としてのR

### 変数へのオブジェクトの代入

x や yという「入れ物」に数字を代入する。

```{r}
x <- 8
y <- 3

z <- x + y
z
```



### プログラミング：繰り返し

同じような作業を繰り返させる。
以下のケースでは、$i$というオブジェクトに1から10までを順番に入れて、それぞれのターンにおいて$i+1$という数字を`print()`という関数でコンソールに表示させている。つまり、同じ作業を10回中身を変えてやりたいときに、`print(1+1), print(2+1)...`というように、何度も同じ文を書く必要がない。

```{r}
for(i in 1:10){
  print(i+1)
}
```

### **練習問題**：ループを用いた計算 {#practiceloop}

1から50までを合計する繰り返し文を書いてみよう。

$1+2+3+\cdots+50=$

ヒント：`goukei`というオブジェクトを用意してみよう。

### プログラミング：if文

もしある命題が真ならどうする、偽ならどうするというifの条件によって異なる処理を行うif文もプログラミングの基本だ。Rでも簡単に実装できる。

```{r}
x <- 5

# もしxが0より大きいなら、yに3+xを代入するという処理を実行する。
if(x > 0){
  y = 3 + x
}

print(y)
```

```{r, error=TRUE}
x <- -4

# もしxが0より大きいなら、wに3+xを代入するという処理を実行する。
if(x > 0){
  w = 3 + x
}

# 上の処理は実行されていないのでwは定義されず、"not found"というエラーが出る。
print(w)
```

もし命題が偽だった場合の処理も指定できる。

```{r}

x <- -5

# もしxが0より大きければ3を足してvに代入、
# そうでなければ3を引いてvに代入。
if(x > 0){
  v = x + 3
}else{
  v = x - 3
}

print(v)
```


## データ型

Rのオブジェクトにはいくつかの「型」がある。そのオブジェクトに格納されている要素がどういう性質を持つか？が定義される。これを、データ型と呼ぶ。
たとえば、数字なのか文字列なのか？で扱いが異なる。

```{r class.source = 'fold-hide'}
# 実数
x <- 634
mode(x)
```

```{r}
# 文字列
y <- "musashi"
mode(y)
```


### データ型：注意点

我々の目には同じ634であっても、データ型が文字列として定義されていると、コンピューターは計算ができない。ただ6.3.4.と書かれている文字であって、数字ではないという認識がなされるからである。

```{r}
# 数字だが文字列
z <- "634"
mode(z)
```

```{r, error = TRUE}
z + 6
```



### データ型の変換



```{r}
# データ型のチェック
mode(z)
# 実数かどうか？
is.numeric(z)
```

```{r}
# データ型を実数に変換して再度zに代入
z <- as.numeric(z)
# 再度チェック
is.numeric(z)
```



## ベクトル

順序のある要素の集まりをベクトルと呼ぶ。
`c()`関数で作成することができる。

```{r}
v1 <- c(1,2,3,4,5)
print(v1)
```

ベクトルは、文字や論理値など取ることができる。

```{r}
v2 <- c("musashi","nerima","ekoda")
print(v2)
```

```{r}
v3 <- c(FALSE,TRUE,TRUE,FALSE)
print(v3)
```




### ベクトルの型

異なるデータ型を同じベクトルに混ぜることはできない。
混ぜると、一定のルールに基づいてある型が他の型より優先される


```{r}
# 数値と論理値を混ぜると、数値になる。(FALSE->0, TRUE->1)
v4 <- c(FALSE,1,TRUE)
print(v4) 
```

```{r}
# 数値と論理値と文字列を混ぜると、全部文字列になる

v5 <- c(FALSE,1,"musashi")
print(v5)
```



### ベクトル：連続した数値

連続した数値を入力したい場合はコロン`:`を使う

```{r}
v6 <- c(1:10)
print(v6)
```

nずつ増える数列を作りたい場合は、`seq()`関数を使う

```{r}
# 例：2から50まで２ずつ増える数列
v7 <- seq(2,50,by=2)
```



### **練習問題**: 数列の作成 {#vectormake}

3から60まで3ずつ増える数列ベクトルを作りなさい



### ベクトルを作る関数1

同じ数値がたくさんあるベクトルを作りたい場合は`rep()`関数を使う

```{r}
# 5が100個ならぶベクトル
v8 <- rep(5,100)
print(v8)
```
--

本当に100個出てるか？
ベクトルの要素の数を数える関数は`length`

```{r}
length(v8)
```



### ベクトル要素の参照

ベクトルのn個目の要素を参照したいときは角カッコを使う`[]`

```{r}
# v7の3つ目の要素は6
v7[3]
```

```{r}
# v7の2,3,5つ目の要素
v7[c(2,3,5)]
```



## リスト

様々なベクトルやデータなどのオブジェクトをひとまとめにして扱うことができるのがリスト

リストは`list()`関数で作成する

```{r}
# aというオブジェクトに、文字列ベクトル、数値ベクトル、データが混ざって入っている。
# カンマ, の後に改行しているが、listのかっこが閉じるまではひとまとまりだと扱われる。

a <- list(
  c("a", "b", NA, "d"),
  num = c(3, 1.1, 5),
  data = head(mtcars, 1))

a
```



### リストの参照

リストの参照も角カッコでできる
```{r}
# リストの参照
a[1]
a[2]
```



### リストの参照

リストの中身のみを取り出したい場合は、二重括角カッコを使う`[[]]`

```{r}
a[[3]]
```